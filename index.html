<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

    <title>Puzzle Box - Lid</title>

    <script>
        const wheelSize = 740;
        const boxSize = 32;
        const fontSize = '18px';
        const symbols = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
    </script>

    <!-- From Green Socks codepen: https://codepen.io/osublake/pen/e86dc71e2406793fb7b899b73f881f67 -->
    <style>
        html, body {
            height: 100%;
        }

        body {
            overflow: scroll;
        }

        #wheel {
            /* Must be set to a defined size (by JavaScript) */
            position: relative;
            outline: 1px solid rgba(255, 0, 0, 0.2); /* DEBUG */
        }

        #wheel-image {
        }

        .box {
            position: absolute;
            top: 0;
            left: 0;
        }

        .box-image {
            /* Contains the text for this slice */
            display: flex;
            align-items: center;
            justify-content: center;
            background: cornflowerblue;
        }

        .container-md {
            background-color: rgba(0, 200, 200, 0.1); /* DEBUG */
        }
    </style>

    <script>
        // Stylesheet rule insertion following guide of: https://stackoverflow.com/a/8630641/5271224
        // Create style sheet inside <head>
        const prevSize = document.styleSheets.length
        const newElemStylesheet = document.createElement('style');
        newElemStylesheet.type = 'text/css';
        document.getElementsByTagName('head')[0].appendChild(newElemStylesheet);

        // Retrieve the actual `styleSheet` object, use it as a closure in a function
        const stylesheet = document.styleSheets[prevSize] // One more than previously existed
        let insertionCount = 0;
        function insertRule(selector, rule) {
            stylesheet.insertRule(selector +' { ' + rule + ' }', insertionCount++);
        }

        // Insert dynamic rules
        insertRule('#wheel', `width: ${wheelSize}px`)
        insertRule('#wheel', `height: ${wheelSize}px`)
        insertRule('#wheel-image', `width: ${wheelSize}px`)
        insertRule('#wheel-image', `height: ${wheelSize}px`)
        insertRule('.box', `width: ${boxSize}px`)
        insertRule('.box', `height: ${boxSize}px`)
        insertRule('.box-image', `width: ${boxSize}px`)
        insertRule('.box-image', `height: ${boxSize}px`)
        insertRule('.box-image', `font-size: ${fontSize}`)
    </script>
</head>
<body>
<div class="container-md">
    <!-- From Green Socks codepen: https://codepen.io/osublake/pen/e86dc71e2406793fb7b899b73f881f67 -->
    <div id="wheel">

        <img id="wheel-image" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/106114/compass3.png" alt="" />

        <!-- Boxes inserted here with JavaScript -->
    </div>
</div>

<!-- Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

<script>
    // Create boxes along circle
    const wheelElem = document.getElementById('wheel');
    for (const symbol of symbols) {
        const textContentElem = document.createTextNode(symbol);

        const textContainerElem = document.createElement('div');
        textContainerElem.classList.add('box-image');// textContainerElem.className = 'box-image';
        textContainerElem.appendChild(textContentElem);

        const outerBoxElem = document.createElement('div');
        outerBoxElem.classList.add('box');// outerBoxElem.className = 'box';
        outerBoxElem.appendChild(textContainerElem);
        outerBoxElem.dataset.character = symbol;

        wheelElem.appendChild(outerBoxElem);
    }
</script>

<!-- From Green Socks codepen: https://codepen.io/osublake/pen/e86dc71e2406793fb7b899b73f881f67 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.2/utils/Draggable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.2/TweenMax.min.js"></script>
<script>
    let wheel = $('#wheel');
    let boxes = $('.box');

    let center = wheelSize / 2; // Center is halfway across the diameter of the entire wheel element
    let radius = center * 0.85; // Radius of circle is slightly smaller than diameter of entire element (based on size of boxes)
    let total  = boxes.length;
    let slice  = 2 * Math.PI / total;

    boxes.each(function(i, box) {

        let angle = i * slice;

        let x = center + radius * Math.sin(angle);
        let y = center - radius * Math.cos(angle);

        TweenLite.set(box, {
            rotation: angle + '_rad',
            xPercent: -50,
            yPercent: -50,
            x: x,
            y: y
        });
    });

    Draggable.create(wheel, {
        type: 'rotation',
        minimumMovement: 10,
        dragClickables: true
    });
</script>
</body>
</html>